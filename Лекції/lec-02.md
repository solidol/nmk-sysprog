# Процес компіляції програми

[Зміст](../README.md)

## Узагальнення



Компіляція програми на C++ включає взяття написаного нами вихідного коду (файли .cpp, .c, .h, .hpp) та перетворення їх у виконуваний файл або бібліотеку, яка може працювати на зазначеній платформі.

Цей процес можна розділити на три основні етапи:

1. Препроцесинг
2. Компіляція
3. Компонування

[Етапи створення виконуваного файлу](img/02-011.png)

## Препроцесінг (попередня обробка)
У C++ є директиви препроцесора (ідентифікуються в коді префіксом #), що визначають перетворення, які мають виконуватися у вихідному коді до його компіляції.

Ви можете дізнатися більше про директиви препроцесора тут. Перший етап компіляції програми на C++ з використанням препроцесора передбачає виконання цих перетворень.

Що робить препроцесор, залежить від директиви.

Наприклад, ми часто розбиваємо код на окремі файли, щоб спростити організацію та читання. Щоб зв'язати код в одному файлі з кодом з іншого, ми використовуємо директиву #include.

При компіляції нашої програми на C++ препроцесор бере цей #include і копіює код, визначений у хедері, файл, який його включає. Це заощаджує наш час і унеможливлює виникнення помилок, які могли б виникнути при ручному копіювання коду між файлами.

Директива include є лише одним прикладом визначених директив, інші приклади ви можете переглянути в цій статті.

До кінця стадії препроцессингу всі директиви препроцесора у вашому коді будуть оброблені препроцесором компілятора, і код буде готовий до компіляції.

## КОМПІЛЯЦІЯ
Компіляція є наступним етапом у процесі і пов'язана з перетворенням вихідного коду, який ми пишемо на щось зрозуміле комп'ютеру — машинний код.

Компіляція C++ як така є двоетапним процесом. По-перше, компілятор бере вихідний код і конвертує його в мову асемблера. Асемблер є мовою програмування низького рівня, яка більшою мірою схожа на машинні інструкції процесора.

По-друге, вихідний код, перетворений на мову асемблера, знову перетворюється на машинний код з використанням асемблера. В результаті виходить набір файлів, що зберігаються в проміжному форматі файлу, відомому як об'єктний файл.

Примітка: машинний код складається з команд, написаних у двійковому форматі, у термінах машинної мови, тому що саме це код, який фактично розуміє процесор.

Об'єктний файл має розширення .obj або .o та створюється для кожного файлу вихідного коду. Об'єктний файл містить усі інструкції машинного рівня для цього файлу. Він згадується як проміжний файл, тому що тільки на заключному етапі, компонуванні, створюється фактичний файл або бібліотека, яку ми можемо використовувати.

На етапі компіляції ми будемо попереджені про будь-які помилки в нашому коді, які призводять до того, що код не компілюється. Усі помилки цьому етапі викликані тим, що компілятор не розуміє написаний нами код.

Код не розпізнається C++, якщо ми десь переплутали наш синтаксис. У типових прикладах невдалої компіляції не вистачає крапки з комою, неправильно написано ключове слово C++ або додано занадто багато фігурних дужок наприкінці методу.

Якщо виявлено помилку, компіляція повністю зупиняється. Ви не зможете скомпілювати свій C++ код, доки всі помилки не будуть виправлені.

## КОМПОНІВКА
Завершальним етапом процесу є компонування, яке пов'язане з вилученням наших результатів з попереднього кроку та зв'язуванням всього цього разом для створення фактичного файлу або бібліотеки, що виконується.

Першим кроком цьому етапі є компіляція всіх об'єктних файлів у виконуваний файл чи бібліотеку. Як тільки цей крок буде успішно завершено, наступним кроком буде зв'язування цього файлу з будь-якими зовнішніми бібліотеками, які ми хочемо використовувати в нашій програмі.

Примітка: бібліотека — це колекція функцій, класів та об'єктів, які мають спільне призначення, наприклад, математична бібліотека.

Зрештою, компонувальник повинен дозволити всі залежності. Це місце, де відбуваються всі помилки, пов'язані з компонуванням.

Серед поширених помилок можна виділити неможливість знайти вказану бібліотеку чи спробу зв'язати два файли, які, наприклад, можуть мати класи з однаковими іменами.

Припускаючи, що на цьому етапі помилок не виникне, компілятор надасть нам файл або бібліотеку, що виконується.

## ЗБІРКА
Я думаю, варто згадати ще одну річ: у IDE, такому як Visual Studio, описані кроки компіляції згруповані в процес, званий складання (build). Типовий робочий процес під час створення програми — складання, та був налагодження (debug).

Відбувається наступне: збірка створює файл, що виконується (шляхом компіляції та компонування коду) або список помилок залежно від того, наскільки добре ми впоралися з написанням коду з часу нашого останнього складання. Коли ми натиснемо Start Debugging, Visual Studio запустить створений виконуваний файл.